<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sophia Knowledge Training Interface</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: pulse 4s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.3; transform: scale(1); }
            50% { opacity: 0.1; transform: scale(1.1); }
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            position: relative;
            z-index: 1;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }

        .main-content {
            padding: 30px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            min-height: 600px;
        }

        .training-panel {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border: 1px solid #e0e0e0;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .training-panel:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
        }

        .panel-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }

        .panel-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-size: 1.5em;
            color: white;
        }

        .panel-icon.upload { background: linear-gradient(135deg, #ff6b6b, #ee5a24); }
        .panel-icon.train { background: linear-gradient(135deg, #4ecdc4, #44a08d); }
        .panel-icon.monitor { background: linear-gradient(135deg, #a8e6cf, #88d8c0); }
        .panel-icon.test { background: linear-gradient(135deg, #ffd93d, #ff6b35); }

        .panel-title {
            font-size: 1.3em;
            font-weight: 600;
            color: #333;
            margin: 0;
        }

        .upload-area {
            border: 3px dashed #ddd;
            border-radius: 10px;
            padding: 40px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 20px;
            background: linear-gradient(45deg, #f8f9fa, #e9ecef);
        }

        .upload-area:hover,
        .upload-area.drag-over {
            border-color: #667eea;
            background: linear-gradient(45deg, #e3f2fd, #bbdefb);
            transform: scale(1.02);
        }

        .upload-icon {
            font-size: 3em;
            color: #667eea;
            margin-bottom: 10px;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s ease;
            background: white;
        }

        .form-control:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            transform: translateY(-2px);
        }

        textarea.form-control {
            resize: vertical;
            min-height: 100px;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        }

        .btn:active {
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #6c757d 0%, #495057 100%);
        }

        .btn-success {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        }

        .btn-warning {
            background: linear-gradient(135deg, #ffc107 0%, #fd7e14 100%);
            color: #212529;
        }

        .progress-container {
            margin: 20px 0;
            display: none;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e9ecef;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2, #667eea);
            background-size: 200% 100%;
            border-radius: 10px;
            transition: width 0.3s ease;
            animation: progressShimmer 2s linear infinite;
            width: 0%;
        }

        @keyframes progressShimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }

        .progress-text {
            text-align: center;
            margin-top: 10px;
            font-weight: 600;
            color: #667eea;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }

        .metric-card {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            border: 1px solid #dee2e6;
            transition: all 0.3s ease;
        }

        .metric-card:hover {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        .metric-value {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .metric-label {
            font-size: 0.9em;
            color: #6c757d;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .log-container {
            max-height: 300px;
            overflow-y: auto;
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
            border: 1px solid #dee2e6;
            font-family: 'Courier New', monospace;
            font-size: 12px;
        }

        .log-entry {
            margin-bottom: 8px;
            padding: 5px 10px;
            border-radius: 5px;
            animation: fadeInUp 0.3s ease;
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .log-entry.info { background: rgba(13, 202, 240, 0.1); color: #0c63e4; }
        .log-entry.success { background: rgba(40, 167, 69, 0.1); color: #157347; }
        .log-entry.warning { background: rgba(255, 193, 7, 0.1); color: #b45309; }
        .log-entry.error { background: rgba(220, 53, 69, 0.1); color: #b02a37; }

        .test-section {
            border-top: 2px solid #e9ecef;
            padding-top: 20px;
            margin-top: 20px;
        }

        .response-box {
            background: #f8f9fa;
            border-left: 4px solid #667eea;
            padding: 20px;
            border-radius: 10px;
            margin-top: 15px;
            font-family: Georgia, serif;
            line-height: 1.6;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .confidence-badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-left: 10px;
        }

        .confidence-high { background: #d4edda; color: #155724; }
        .confidence-medium { background: #fff3cd; color: #856404; }
        .confidence-low { background: #f8d7da; color: #721c24; }

        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
            animation: pulse 2s infinite;
        }

        .status-indicator.active { background: #28a745; }
        .status-indicator.inactive { background: #6c757d; }
        .status-indicator.processing { background: #ffc107; }

        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
                gap: 20px;
            }
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 15px;
            }
            
            .header {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .main-content {
                padding: 20px;
            }
            
            .metrics-grid {
                grid-template-columns: 1fr;
                gap: 10px;
            }
        }

        .floating-action {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5em;
            cursor: pointer;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .floating-action:hover {
            transform: scale(1.1) rotate(10deg);
            box-shadow: 0 12px 35px rgba(102, 126, 234, 0.4);
        }

        .tooltip {
            position: relative;
            cursor: help;
        }

        .tooltip::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: #333;
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 12px;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
            z-index: 1000;
        }

        .tooltip:hover::after {
            opacity: 1;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🧠 Sophia Knowledge Training</h1>
            <p>Advanced AI Knowledge Domination System</p>
        </div>

        <div class="main-content">
            <!-- Knowledge Upload Panel -->
            <div class="training-panel">
                <div class="panel-header">
                    <div class="panel-icon upload">📚</div>
                    <h2 class="panel-title">Knowledge Sources</h2>
                </div>

                <div class="upload-area" id="uploadArea">
                    <div class="upload-icon">☁️</div>
                    <h3>Drop files here or click to upload</h3>
                    <p>Supports PDFs, Word docs, text files, URLs, and more</p>
                    <input type="file" id="fileInput" multiple accept=".pdf,.docx,.doc,.txt,.md,.json" style="display: none;">
                </div>

                <div class="form-group">
                    <label for="urlInput">🌐 Web URL or API Endpoint:</label>
                    <input type="url" class="form-control" id="urlInput" placeholder="https://example.com/knowledge-source">
                </div>

                <div class="form-group">
                    <label for="textInput">✏️ Direct Text Input:</label>
                    <textarea class="form-control" id="textInput" placeholder="Paste your knowledge content here..." rows="4"></textarea>
                </div>

                <button class="btn" onclick="startIngestion()">🚀 Start Learning</button>
                <button class="btn btn-secondary" onclick="clearSources()" style="margin-left: 10px;">🗑️ Clear</button>

                <div class="progress-container" id="progressContainer">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <div class="progress-text" id="progressText">Processing...</div>
                </div>
            </div>

            <!-- Training Control Panel -->
            <div class="training-panel">
                <div class="panel-header">
                    <div class="panel-icon train">⚙️</div>
                    <h2 class="panel-title">Custom Training</h2>
                </div>

                <div class="form-group">
                    <label for="queryInput">❓ Training Query:</label>
                    <input type="text" class="form-control" id="queryInput" placeholder="What question should Sophia learn to answer?">
                </div>

                <div class="form-group">
                    <label for="responseInput">💡 Desired Response:</label>
                    <textarea class="form-control" id="responseInput" placeholder="How should Sophia respond to this query?" rows="4"></textarea>
                </div>

                <div class="form-group">
                    <label for="contextInput">🎯 Context (Optional):</label>
                    <input type="text" class="form-control" id="contextInput" placeholder="Additional context or domain">
                </div>

                <button class="btn btn-success" onclick="trainCustomResponse()">🎯 Train Response</button>

                <div class="test-section">
                    <h3>🧪 Test Knowledge</h3>
                    <div class="form-group">
                        <label for="testQuery">Test Query:</label>
                        <input type="text" class="form-control" id="testQuery" placeholder="Ask Sophia anything...">
                    </div>
                    <button class="btn btn-warning" onclick="testKnowledge()">🔍 Test</button>
                    
                    <div class="response-box" id="testResponse" style="display: none;">
                        <div id="responseContent"></div>
                        <div style="margin-top: 10px; font-size: 0.9em; color: #6c757d;">
                            <strong>Confidence:</strong> <span id="confidenceScore"></span>
                            <strong style="margin-left: 15px;">Processing Time:</strong> <span id="processingTime"></span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Monitoring Panel -->
            <div class="training-panel">
                <div class="panel-header">
                    <div class="panel-icon monitor">📊</div>
                    <h2 class="panel-title">Performance Monitor</h2>
                </div>

                <div class="metrics-grid">
                    <div class="metric-card tooltip" data-tooltip="Total pieces of knowledge processed">
                        <div class="metric-value" id="knowledgeCount">0</div>
                        <div class="metric-label">Knowledge Items</div>
                    </div>
                    <div class="metric-card tooltip" data-tooltip="Concepts learned and indexed">
                        <div class="metric-value" id="conceptsCount">0</div>
                        <div class="metric-label">Concepts</div>
                    </div>
                    <div class="metric-card tooltip" data-tooltip="Overall learning effectiveness score">
                        <div class="metric-value" id="learningScore">0%</div>
                        <div class="metric-label">Learning Score</div>
                    </div>
                    <div class="metric-card tooltip" data-tooltip="System processing efficiency">
                        <div class="metric-value" id="efficiency">0%</div>
                        <div class="metric-label">Efficiency</div>
                    </div>
                </div>

                <div style="margin-top: 20px;">
                    <h4>🎯 Learning Objectives</h4>
                    <div id="objectivesList">
                        <div style="padding: 10px; background: #f8f9fa; border-radius: 5px; margin: 5px 0;">
                            <span class="status-indicator active"></span>
                            <strong>Knowledge Retention:</strong> 85%
                        </div>
                        <div style="padding: 10px; background: #f8f9fa; border-radius: 5px; margin: 5px 0;">
                            <span class="status-indicator processing"></span>
                            <strong>Response Quality:</strong> 78%
                        </div>
                        <div style="padding: 10px; background: #f8f9fa; border-radius: 5px; margin: 5px 0;">
                            <span class="status-indicator active"></span>
                            <strong>Learning Efficiency:</strong> 92%
                        </div>
                    </div>
                </div>

                <button class="btn" onclick="optimizePerformance()" style="margin-top: 15px;">⚡ Optimize System</button>
                <button class="btn btn-secondary" onclick="exportMetrics()" style="margin-left: 10px;">📈 Export Data</button>
            </div>

            <!-- Activity Log Panel -->
            <div class="training-panel">
                <div class="panel-header">
                    <div class="panel-icon test">📝</div>
                    <h2 class="panel-title">Activity Log</h2>
                </div>

                <div class="log-container" id="activityLog">
                    <div class="log-entry info">
                        <strong>[12:34:56]</strong> Knowledge Domination Swarm initialized successfully
                    </div>
                    <div class="log-entry success">
                        <strong>[12:35:02]</strong> Neural memory system ready - 0 nodes, 0 relationships
                    </div>
                    <div class="log-entry info">
                        <strong>[12:35:03]</strong> All specialized agents online and ready
                    </div>
                </div>

                <div style="margin-top: 20px;">
                    <button class="btn btn-secondary" onclick="clearLog()">🗑️ Clear Log</button>
                    <button class="btn btn-secondary" onclick="downloadLog()" style="margin-left: 10px;">💾 Download</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Floating Action Button -->
    <div class="floating-action tooltip" data-tooltip="Emergency Stop" onclick="emergencyStop()">
        ⏹️
    </div>

    <script>
        // Global state
        let trainingSession = null;
        let knowledgeStats = {
            items: 0,
            concepts: 0,
            learning: 0,
            efficiency: 0
        };

        // Initialize the interface
        document.addEventListener('DOMContentLoaded', function() {
            initializeInterface();
            startPerformanceMonitoring();
        });

        function initializeInterface() {
            // Setup drag and drop
            const uploadArea = document.getElementById('uploadArea');
            const fileInput = document.getElementById('fileInput');

            uploadArea.addEventListener('click', () => fileInput.click());
            uploadArea.addEventListener('dragover', handleDragOver);
            uploadArea.addEventListener('dragleave', handleDragLeave);
            uploadArea.addEventListener('drop', handleDrop);

            fileInput.addEventListener('change', handleFileSelect);

            // Add keyboard shortcuts
            document.addEventListener('keydown', handleKeyboardShortcuts);

            addLog('info', 'Training interface initialized successfully');
        }

        function handleDragOver(e) {
            e.preventDefault();
            e.currentTarget.classList.add('drag-over');
        }

        function handleDragLeave(e) {
            e.currentTarget.classList.remove('drag-over');
        }

        function handleDrop(e) {
            e.preventDefault();
            e.currentTarget.classList.remove('drag-over');
            
            const files = Array.from(e.dataTransfer.files);
            processFiles(files);
        }

        function handleFileSelect(e) {
            const files = Array.from(e.target.files);
            processFiles(files);
        }

        function handleKeyboardShortcuts(e) {
            if (e.ctrlKey || e.metaKey) {
                switch(e.key) {
                    case 'l':
                        e.preventDefault();
                        startIngestion();
                        break;
                    case 't':
                        e.preventDefault();
                        document.getElementById('testQuery').focus();
                        break;
                    case 'Enter':
                        if (e.target.id === 'testQuery') {
                            e.preventDefault();
                            testKnowledge();
                        }
                        break;
                }
            }
        }

        function processFiles(files) {
            files.forEach(file => {
                addLog('info', `File selected: ${file.name} (${formatFileSize(file.size)})`);
            });
        }

        async function startIngestion() {
            const urlInput = document.getElementById('urlInput').value;
            const textInput = document.getElementById('textInput').value;
            const fileInput = document.getElementById('fileInput').files;

            if (!urlInput && !textInput && fileInput.length === 0) {
                addLog('warning', 'Please provide at least one knowledge source');
                return;
            }

            showProgress(true);
            addLog('info', 'Starting knowledge ingestion process...');

            try {
                // Simulate API call to knowledge ingestion endpoint
                const sources = [];
                
                if (urlInput) sources.push({type: 'url', source: urlInput});
                if (textInput) sources.push({type: 'text', source: textInput});
                
                Array.from(fileInput).forEach(file => {
                    sources.push({type: 'file', source: file.name});
                });

                for (let i = 0; i < sources.length; i++) {
                    const source = sources[i];
                    const progress = ((i + 1) / sources.length) * 100;
                    
                    updateProgress(progress, `Processing ${source.type}: ${source.source}`);
                    
                    // Simulate processing delay
                    await sleep(1000 + Math.random() * 2000);
                    
                    // Simulate results
                    const fragments = Math.floor(Math.random() * 20) + 5;
                    const concepts = Math.floor(Math.random() * 10) + 2;
                    
                    knowledgeStats.items += fragments;
                    knowledgeStats.concepts += concepts;
                    
                    addLog('success', `Processed ${source.type}: ${fragments} fragments, ${concepts} concepts extracted`);
                }

                knowledgeStats.learning = Math.min(100, knowledgeStats.learning + Math.random() * 15 + 5);
                knowledgeStats.efficiency = Math.min(100, knowledgeStats.efficiency + Math.random() * 10 + 3);

                updateMetrics();
                addLog('success', 'Knowledge ingestion completed successfully');
                
            } catch (error) {
                addLog('error', `Ingestion failed: ${error.message}`);
            } finally {
                showProgress(false);
            }
        }

        async function trainCustomResponse() {
            const query = document.getElementById('queryInput').value;
            const response = document.getElementById('responseInput').value;
            const context = document.getElementById('contextInput').value;

            if (!query || !response) {
                addLog('warning', 'Please provide both query and desired response');
                return;
            }

            addLog('info', `Training custom response for: "${query.substring(0, 50)}..."`);

            try {
                // Simulate API call to custom training endpoint
                await sleep(1500);
                
                const patterns = Math.floor(Math.random() * 5) + 2;
                knowledgeStats.learning = Math.min(100, knowledgeStats.learning + 8);
                
                updateMetrics();
                addLog('success', `Custom response trained successfully. ${patterns} patterns extracted.`);
                
                // Clear the form
                document.getElementById('queryInput').value = '';
                document.getElementById('responseInput').value = '';
                document.getElementById('contextInput').value = '';
                
            } catch (error) {
                addLog('error', `Custom training failed: ${error.message}`);
            }
        }

        async function testKnowledge() {
            const query = document.getElementById('testQuery').value;
            
            if (!query) {
                addLog('warning', 'Please enter a test query');
                return;
            }

            addLog('info', `Testing knowledge: "${query}"`);
            
            try {
                // Simulate API call to knowledge testing endpoint
                const startTime = Date.now();
                await sleep(800 + Math.random() * 1200);
                const processingTime = Date.now() - startTime;
                
                // Generate simulated response
                const responses = [
                    "Based on my knowledge, this is a comprehensive explanation of the topic. The key concepts involve several interconnected principles that demonstrate the complexity and depth of the subject matter.",
                    "This question touches on an important area where multiple disciplines converge. The answer requires understanding both theoretical foundations and practical applications.",
                    "From my analysis of the available information, I can provide several perspectives on this topic, each offering valuable insights into the underlying mechanisms.",
                    "The topic you've asked about involves sophisticated concepts that can be understood through careful examination of the relationships between different components."
                ];
                
                const response = responses[Math.floor(Math.random() * responses.length)];
                const confidence = 0.6 + Math.random() * 0.35; // 60-95% confidence
                
                displayTestResponse(response, confidence, processingTime);
                addLog('success', `Knowledge test completed (confidence: ${(confidence * 100).toFixed(1)}%)`);
                
            } catch (error) {
                addLog('error', `Knowledge test failed: ${error.message}`);
            }
        }

        function displayTestResponse(response, confidence, processingTime) {
            const responseBox = document.getElementById('testResponse');
            const responseContent = document.getElementById('responseContent');
            const confidenceScore = document.getElementById('confidenceScore');
            const processingTimeEl = document.getElementById('processingTime');
            
            responseContent.textContent = response;
            
            const confidencePercent = (confidence * 100).toFixed(1);
            let confidenceClass = 'confidence-low';
            if (confidence > 0.8) confidenceClass = 'confidence-high';
            else if (confidence > 0.6) confidenceClass = 'confidence-medium';
            
            confidenceScore.innerHTML = `<span class="confidence-badge ${confidenceClass}">${confidencePercent}%</span>`;
            processingTimeEl.textContent = `${processingTime}ms`;
            
            responseBox.style.display = 'block';
            responseBox.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        async function optimizePerformance() {
            addLog('info', 'Starting performance optimization...');
            
            try {
                await sleep(2000);
                
                const improvement = Math.random() * 20 + 5;
                knowledgeStats.efficiency = Math.min(100, knowledgeStats.efficiency + improvement);
                knowledgeStats.learning = Math.min(100, knowledgeStats.learning + improvement * 0.5);
                
                updateMetrics();
                addLog('success', `Performance optimization completed (+${improvement.toFixed(1)}% efficiency)`);
                
            } catch (error) {
                addLog('error', `Optimization failed: ${error.message}`);
            }
        }

        function clearSources() {
            document.getElementById('urlInput').value = '';
            document.getElementById('textInput').value = '';
            document.getElementById('fileInput').value = '';
            addLog('info', 'Knowledge sources cleared');
        }

        function clearLog() {
            document.getElementById('activityLog').innerHTML = '';
            addLog('info', 'Activity log cleared');
        }

        function emergencyStop() {
            if (confirm('Are you sure you want to stop all training processes?')) {
                showProgress(false);
                addLog('warning', 'Emergency stop activated - all processes halted');
            }
        }

        function exportMetrics() {
            const data = {
                timestamp: new Date().toISOString(),
                metrics: knowledgeStats,
                session: trainingSession
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], {type: 'application/json'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `sophia-training-metrics-${Date.now()}.json`;
            a.click();
            URL.revokeObjectURL(url);
            
            addLog('info', 'Training metrics exported successfully');
        }

        function downloadLog() {
            const logEntries = Array.from(document.querySelectorAll('.log-entry')).map(entry => entry.textContent);
            const logText = logEntries.join('\n');
            
            const blob = new Blob([logText], {type: 'text/plain'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `sophia-training-log-${Date.now()}.txt`;
            a.click();
            URL.revokeObjectURL(url);
            
            addLog('info', 'Activity log downloaded successfully');
        }

        function showProgress(show) {
            const container = document.getElementById('progressContainer');
            container.style.display = show ? 'block' : 'none';
            
            if (!show) {
                updateProgress(0, '');
            }
        }

        function updateProgress(percent, text) {
            const fill = document.getElementById('progressFill');
            const textEl = document.getElementById('progressText');
            
            fill.style.width = `${percent}%`;
            textEl.textContent = text || `${percent.toFixed(1)}%`;
        }

        function updateMetrics() {
            document.getElementById('knowledgeCount').textContent = knowledgeStats.items.toLocaleString();
            document.getElementById('conceptsCount').textContent = knowledgeStats.concepts.toLocaleString();
            document.getElementById('learningScore').textContent = `${knowledgeStats.learning.toFixed(1)}%`;
            document.getElementById('efficiency').textContent = `${knowledgeStats.efficiency.toFixed(1)}%`;
        }

        function addLog(type, message) {
            const log = document.getElementById('activityLog');
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            
            const timestamp = new Date().toLocaleTimeString();
            entry.innerHTML = `<strong>[${timestamp}]</strong> ${message}`;
            
            log.appendChild(entry);
            log.scrollTop = log.scrollHeight;
            
            // Limit log entries
            while (log.children.length > 100) {
                log.removeChild(log.firstChild);
            }
        }

        function startPerformanceMonitoring() {
            // Simulate real-time performance updates
            setInterval(() => {
                // Random small improvements to simulate ongoing learning
                if (Math.random() < 0.1) { // 10% chance per interval
                    const improvement = Math.random() * 2;
                    knowledgeStats.efficiency = Math.min(100, knowledgeStats.efficiency + improvement * 0.1);
                    knowledgeStats.learning = Math.min(100, knowledgeStats.learning + improvement * 0.05);
                    updateMetrics();
                }
            }, 5000);
        }

        function formatFileSize(bytes) {
            const units = ['B', 'KB', 'MB', 'GB'];
            let size = bytes;
            let unitIndex = 0;
            
            while (size >= 1024 && unitIndex < units.length - 1) {
                size /= 1024;
                unitIndex++;
            }
            
            return `${size.toFixed(1)} ${units[unitIndex]}`;
        }

        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        // Initialize with some demo data
        knowledgeStats = {
            items: Math.floor(Math.random() * 1000) + 100,
            concepts: Math.floor(Math.random() * 200) + 50,
            learning: Math.random() * 40 + 60,  // 60-100%
            efficiency: Math.random() * 30 + 70   // 70-100%
        };

        updateMetrics();
    </script>
</body>
</html>