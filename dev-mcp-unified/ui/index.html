<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sophia & Artemis</title>
  <style>
    body{margin:0;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:#0f1115;color:#e5e7eb}
    .tabs{display:flex;gap:8px;border-bottom:1px solid #23262d;padding:10px}
    .tab{padding:8px 12px;border:1px solid #23262d;border-bottom:none;border-radius:8px 8px 0 0;background:#12151b;cursor:pointer}
    .tab.active{background:#1a1f2b;color:#93c5fd;border-color:#3b82f6}
    .view{height:calc(100vh - 54px)}
    iframe{width:100%;height:100%;border:0}
    .placeholder{padding:18px}
  </style>
</head>
<body>
  <div class="tabs">
    <div class="tab active" id="tab-artemis" onclick="show('artemis')">Artemis (Coding)</div>
    <div class="tab" id="tab-sophia" onclick="show('sophia')">Sophia (Business)</div>
  </div>
  <div class="view">
    <iframe id="frame-artemis" src="./multi-chat-six.html"></iframe>
    <div id="frame-sophia" class="placeholder" style="display:none">
      <h2>Business Dashboard (Sophia)</h2>
      <div style="margin:12px 0;">
        <button onclick="loadGong()">Load recent Gong calls (7d)</button>
        <span id="gong-status" style="margin-left:10px;color:#9ca3af;"></span>
      </div>
      <div id="gong-list" style="margin-top:10px;display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:10px;"></div>
      <script>
        async function loadGong(){
          const st = document.getElementById('gong-status');
          const list = document.getElementById('gong-list');
          st.textContent = 'loadingâ€¦';
          try{
            const r = await fetch('http://127.0.0.1:3333/business/gong/recent?days=7');
            const data = await r.json();
            st.textContent = data.error ? ('error: ' + data.error) : `loaded ${data.count}`;
            list.innerHTML = '';
            (data.calls||[]).forEach(c => {
              const card = document.createElement('div');
              card.style.border='1px solid #23262d';
              card.style.borderRadius='8px';
              card.style.padding='10px';
              card.style.background='#12151b';
              card.innerHTML = `<div style="color:#93c5fd;font-weight:600">${(c.topic||'Call')}</div>
                <div class="small">${c.date||''}</div>
                <div class="small">Duration: ${c.durationSec||'-'}s</div>`;
              list.appendChild(card);
            });
          }catch(e){
            st.textContent = 'error: ' + e;
          }
        }
      </script>
    </div>
  </div>
  <script>
    function show(which){
      document.getElementById('tab-artemis').classList.toggle('active', which==='artemis');
      document.getElementById('tab-sophia').classList.toggle('active', which==='sophia');
      document.getElementById('frame-artemis').style.display = (which==='artemis') ? 'block' : 'none';
      document.getElementById('frame-sophia').style.display = (which==='sophia') ? 'block' : 'none';
    }
  </script>
</body>
</html>
